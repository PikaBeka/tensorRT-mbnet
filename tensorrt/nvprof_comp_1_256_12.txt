==14642== NVPROF is profiling process 14642, command: ./mbnet
==14642== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==14642== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==14642== Profiling application: ./mbnet
==14642== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   65.86%  29.2534s     10003  2.9245ms  582.98us  6.8180ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                   29.13%  12.9418s     10026  1.2908ms  1.0240us  9.0948ms  [CUDA memcpy DtoH]
                    2.95%  1.31213s     20048  65.449us  28.640us  80.480us  [CUDA memcpy DtoD]
                    0.99%  437.95ms     40117  10.916us     192ns  498.24us  [CUDA memcpy HtoD]
                    0.10%  44.126ms     40081  1.1000us     160ns  459.59us  [CUDA memset]
                    0.10%  43.901ms        10  4.3901ms  2.4054ms  11.326ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=4, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.10%  43.406ms         3  14.469ms  14.451ms  14.496ms  void gemv2T_kernel_val<int, int, float2, float2, float2, int=128, int=16, int=2, int=2, bool=0, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const , float2, float2)
                    0.08%  34.536ms       243  142.12us  138.40us  148.32us  void gemv2N_kernel<int, int, float2, float2, float2, int=128, int=8, int=4, int=4, int=1, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const )
                    0.07%  32.462ms        10  3.2462ms  2.5675ms  6.5036ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.07%  32.072ms         5  6.4143ms  6.2308ms  6.4895ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=4>, fused::KpqkPtrWriter<float, int=1, int=1, int=4>, float, float, int=5, int=3, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.05%  24.077ms         5  4.8155ms  3.2818ms  8.0837ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=3, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.04%  16.388ms         5  3.2777ms  3.2480ms  3.2981ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  14.000ms         5  2.8000ms  2.7474ms  2.8590ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  12.941ms         5  2.5881ms  2.5451ms  2.6129ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  12.516ms         5  2.5031ms  2.4539ms  2.5291ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=3, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  12.430ms         3  4.1432ms  3.6639ms  4.3937ms  void explicit_convolve_sgemm<float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0>(int, int, int, float const *, int, float const *, int, float*, kernel_conv_params, __int64, int, __int64, int, float, float, int, float const *, float const *)
                    0.03%  12.115ms         5  2.4231ms  2.3240ms  2.7424ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=5, int=2, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.02%  9.1620ms        15  610.80us  381.60us  729.29us  void op_generic_tensor_kernel<int=3, float, float, float, int=256, cudnnGenericOp_t=0, cudnnNanPropagation_t=0, int=0>(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, cudnnTensorStruct, float const *, float, float, float, cudnnActivationStruct, reducedDivisorArray, int)
                    0.02%  6.8120ms         3  2.2707ms  2.2635ms  2.2837ms  trt_maxwell_scudnn_128x128_relu_large_nn_v0
                    0.02%  6.8012ms         3  2.2671ms  2.2592ms  2.2771ms  trt_maxwell_scudnn_128x128_relu_medium_nn_v0
                    0.02%  6.7421ms         3  2.2474ms  2.2395ms  2.2599ms  trt_maxwell_scudnn_128x128_relu_small_nn_v0
                    0.01%  6.6205ms         3  2.2068ms  2.2000ms  2.2189ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v0
                    0.01%  6.6041ms         3  2.2014ms  2.1939ms  2.2149ms  trt_maxwell_scudnn_128x128_relu_large_nn_v1
                    0.01%  6.5571ms         3  2.1857ms  2.1800ms  2.1969ms  trt_maxwell_scudnn_128x128_relu_medium_nn_v1
                    0.01%  6.5137ms         3  2.1712ms  2.1639ms  2.1820ms  trt_maxwell_scudnn_128x128_relu_small_nn_v1
                    0.01%  6.4404ms         3  2.1468ms  2.1444ms  2.1514ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                    0.01%  5.4937ms         3  1.8312ms  1.8228ms  1.8477ms  void implicit_convolve_sgemm<float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=0, bool=0, bool=1>(int, int, int, float const *, int, float*, float const *, kernel_conv_params, __int64, int, float, float, int, float const *, float const *, bool, int, int)
                    0.01%  5.1816ms         3  1.7272ms  1.7168ms  1.7471ms  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=1, unsigned char=0, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig2DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=2, int=64, int=64, int=256, char=4, bool=0, bool=1, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.01%  4.3522ms         3  1.4507ms  1.4464ms  1.4538ms  maxwell_scudnn_128x32_relu_small_nn_v1
                    0.01%  3.7501ms         9  416.68us  251.36us  512.16us  void transpose_readWrite_alignment_kernel<float2, float2, int=1, bool=0, int=6, int=4, int=4>(cublasTransposeParams<float2>, float2 const *, float2*, float2 const *)
                    0.01%  3.3697ms         3  1.1232ms  1.1163ms  1.1351ms  trt_maxwell_scudnn_128x64_relu_large_nn_v1
                    0.01%  3.3308ms         3  1.1103ms  1.1026ms  1.1246ms  trt_maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.01%  3.2847ms         3  1.0949ms  1.0885ms  1.1055ms  trt_maxwell_scudnn_128x64_relu_large_nn_v0
                    0.01%  3.2834ms         3  1.0945ms  1.0879ms  1.1057ms  trt_maxwell_scudnn_128x64_relu_medium_nn_v0
                    0.01%  3.2643ms         3  1.0881ms  1.0807ms  1.1012ms  trt_maxwell_scudnn_128x64_relu_small_nn_v1
                    0.01%  3.2533ms         3  1.0844ms  1.0772ms  1.0970ms  trt_maxwell_scudnn_128x64_relu_interior_nn_v1
                    0.01%  3.2487ms         3  1.0829ms  1.0759ms  1.0946ms  trt_maxwell_scudnn_128x64_relu_small_nn_v0
                    0.01%  3.1619ms         3  1.0540ms  1.0458ms  1.0643ms  trt_maxwell_scudnn_128x64_relu_interior_nn_v0
                    0.01%  3.0851ms         3  1.0284ms  983.69us  1.0578ms  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::IdentityCoordMapper<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayN, int, int, int, float const *, void*, genericReformat::ArrayN, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayN, int, int, int, float const , int=4)
                    0.01%  3.0764ms         3  1.0255ms  977.96us  1.0516ms  void DSE::regular_fft_clip<int=1, int=2, int=256, int=16, int=16, int=1, float, float, float2>(float*, float2*, int, int3, float2*, int, float2*, float2*, int, int, int, int, int, float, float, bool, int, float, float)
                    0.01%  2.4038ms         3  801.25us  787.59us  814.95us  trt_maxwell_scudnn_128x32_relu_medium_nn_v1
                    0.01%  2.4019ms       243  9.8840us  7.6800us  26.560us  void fft2d_c2r_32x32<float, bool=0, bool=0, unsigned int=0, bool=0, bool=0>(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*, int2, int, int)
                    0.01%  2.2824ms         3  760.81us  750.25us  772.65us  trt_maxwell_scudnn_128x32_relu_large_nn_v1
                    0.00%  2.1524ms         3  717.46us  711.37us  725.45us  trt_maxwell_scudnn_128x32_relu_large_nn_v0
                    0.00%  2.1246ms         3  708.21us  701.57us  720.61us  trt_maxwell_scudnn_128x32_relu_small_nn_v1
                    0.00%  2.0916ms         3  697.20us  689.13us  710.89us  trt_maxwell_scudnn_128x32_relu_interior_nn_v1
                    0.00%  2.0758ms       243  8.5420us  6.1120us  23.232us  void fft2d_r2c_32x32<float, bool=0, unsigned int=0, bool=0>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.00%  1.9881ms         3  662.69us  656.80us  672.49us  trt_maxwell_scudnn_128x32_relu_medium_nn_v0
                    0.00%  1.9567ms         3  652.24us  645.12us  663.20us  trt_maxwell_scudnn_128x32_relu_small_nn_v0
                    0.00%  1.7501ms         3  583.36us  523.52us  615.20us  void cudnn::cnn::im2col4d_kernel<float, long>(cudnn::cnn::im2col4d_params, cudnnConvolutionStruct, cudnnTensorStruct, float const *, cudnnTensorStruct*)
                    0.00%  1.5554ms         6  259.23us  62.272us  458.88us  void DSE::regular_fft_pad<int=0, int=1, int=256, int=16, int=16, int=1, float, float, float2>(float2*, float*, int, int3, float*, int, float*, float*, int, int, int, int, int, bool)
                    0.00%  893.96us         6  148.99us  29.441us  278.08us  void DSE::vector_fft<int=0, int=1, int=256, int=16, int=16, int=1, float, float, float2>(float2*, float2, int, int3, float2*)
                    0.00%  861.29us         4  215.32us  212.96us  220.00us  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=1, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=0, unsigned char=1, bool=1, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig1DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=1, int=256, int=1, int=64, char=4, bool=1, bool=0, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.00%  845.77us         4  211.44us  210.69us  213.63us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::ArrayN<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::ArrayN<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::ArrayN<int=4>>, void const *, int, int, int, float const *, void*, void const *, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, void const *, int, int, int, float const , int=4)
                    0.00%  788.03us        25  31.521us  30.944us  33.921us  void cask_trt::computeOffsetsKernel<bool=0, bool=0>(cask_trt::ComputeOffsetsParams)
                    0.00%  722.60us         3  240.87us  239.20us  243.52us  void DSE::vector_fft<int=1, int=2, int=256, int=16, int=16, int=1, float, float, float2>(float2*, float2, int, int3, float2*)
                    0.00%  194.95us         3  64.982us  64.224us  65.921us  void cask_cudnn::computeOffsetsKernel<bool=0, bool=0>(cask_cudnn::ComputeOffsetsParams)
                    0.00%  52.993us         3  17.664us  16.513us  18.560us  void fft2d_r2c_32x32<float, bool=0, unsigned int=5, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
      API calls:   32.84%  43.9515s     30049  1.4627ms  4.5120us  12.506ms  cudaStreamSynchronize
                   24.40%  32.6604s     50010  653.08us  27.200us  118.47ms  cudaMemcpy
                    7.79%  10.4279s    140146  74.407us  13.729us  6.7691ms  cudaMalloc
                    7.72%  10.3330s    260173  39.715us  1.4080us  1.29185s  cudaFree
                    4.63%  6.20197s     10003  620.01us  47.712us  1.8500ms  cudaFreeHost
                    4.30%  5.76153s     10003  575.98us  81.152us  2.1700ms  cudaHostAlloc
                    3.27%  4.37785s     80026  54.705us  7.2640us  2.46890s  cudaMemGetInfo
                    2.46%  3.29292s     80025  41.148us  2.9760us  2.70029s  cudaStreamCreateWithFlags
                    1.87%  2.50766s     10958  228.84us  27.104us  1.78873s  cudaLaunchKernel
                    1.73%  2.31639s     20233  114.49us     928ns  990.02us  cudaMemcpyAsync
                    1.58%  2.12125s    810304  2.6170us     448ns  1.0281ms  cudaDeviceGetAttribute
                    1.15%  1.53402s    480141  3.1940us  1.4080us  4.2694ms  cudaEventDestroy
                    1.10%  1.46767s       159  9.2307ms  8.2560us  164.31ms  cuModuleUnload
                    1.00%  1.33588s    480138  2.7820us  1.4400us  4.1258ms  cudaEventCreateWithFlags
                    0.93%  1.24503s     30014  41.481us  27.296us  1.1615ms  cudaGetDeviceProperties
                    0.80%  1.06588s     40081  26.593us  14.016us  743.56us  cudaMemsetAsync
                    0.72%  958.39ms    130038  7.3700us  3.5840us  8.1591ms  cudaStreamDestroy
                    0.68%  916.21ms     70021  13.084us  4.1920us  5.5680ms  cudaDeviceSynchronize
                    0.32%  427.13ms       156  2.7380ms  334.08us  17.784ms  cudaEventSynchronize
                    0.16%  213.07ms     60026  3.5490us  1.2800us  664.20us  cudaGetDevice
                    0.13%  168.88ms     10001  16.886us  12.992us  3.4010ms  cudaStreamCreate
                    0.12%  162.89ms     40012  4.0710us  2.8480us  628.64us  cudaStreamCreateWithPriority
                    0.09%  125.17ms     10357  12.085us  1.9520us  446.63us  cudaEventRecord
                    0.09%  119.71ms     51105  2.3420us     416ns  633.19us  cudaGetLastError
                    0.05%  64.122ms     10003  6.4100us  4.0320us  85.824us  cudaHostGetDevicePointer
                    0.03%  40.493ms     30010  1.3490us     384ns  616.36us  cudaGetDeviceCount
                    0.02%  23.194ms     10003  2.3180us  1.7920us  107.26us  cudaDeviceGetStreamPriorityRange
                    0.01%  12.293ms     20008     614ns     384ns  658.72us  cudaRuntimeGetVersion
                    0.01%  7.3473ms     10004     734ns     480ns  3.6480us  cudaDriverGetVersion
                    0.00%  6.4493ms       156  41.341us  18.720us  286.27us  cudaStreamAddCallback
                    0.00%  1.6760ms       156  10.743us  4.6400us  62.976us  cudaEventElapsedTime
                    0.00%  1.0097ms       303  3.3320us  1.7280us  29.472us  cudaStreamWaitEvent
                    0.00%  658.02us        11  59.820us  34.977us  125.31us  cudaCreateTextureObject
                    0.00%  646.31us       568  1.1370us     416ns  49.152us  cuDeviceGetAttribute
                    0.00%  187.33us        11  17.030us  11.008us  24.417us  cudaDestroyTextureObject
                    0.00%  83.968us         6  13.994us  7.1680us  18.048us  cuDeviceTotalMem
                    0.00%  43.169us         3  14.389us  10.016us  16.992us  cudaEventCreate
                    0.00%  25.729us         5  5.1450us  3.6490us  6.0160us  cuInit
                    0.00%  15.777us         8  1.9720us     992ns  4.9920us  cuDeviceGetCount
                    0.00%  11.776us         5  2.3550us  1.6640us  4.1920us  cuDriverGetVersion
                    0.00%  11.680us         6  1.9460us  1.6640us  2.3680us  cuDeviceGetName
                    0.00%  11.104us        11  1.0090us     640ns  1.3760us  cudaCreateChannelDesc
                    0.00%  9.4400us         7  1.3480us     832ns  1.9520us  cuDeviceGet
                    0.00%  4.9920us         6     832ns     672ns  1.2160us  cuDeviceGetUuid
                    0.00%  4.9600us         7     708ns     608ns     832ns  cudaPeekAtLastError
                    0.00%  3.6480us         2  1.8240us  1.7920us  1.8560us  cuDevicePrimaryCtxRelease

==14642== NVTX result:
==14642==   Thread "<unnamed>" (id = 2414886928)
==14642==     Domain "TensorRT"
==14642==       Range "(Unnamed Layer* 0) [Convolution]"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  919.38ms     10000  91.937us  67.617us  1.2189ms  (Unnamed Layer* 0) [Convolution]
 GPU activities:  100.00%  29.2516s     10000  2.9252ms  582.98us  6.8180ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
      API calls:  100.00%  681.33ms     10000  68.132us  50.176us  1.1919ms  cudaLaunchKernel

==14642==       Range "ExecutionContext::execute"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  41.8187s     10000  4.1819ms  929.41us  9.3320ms  ExecutionContext::execute
 GPU activities:   97.80%  29.2516s     10000  2.9252ms  582.98us  6.8180ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    2.20%  658.86ms     10000  65.886us  28.896us  80.480us  [CUDA memcpy DtoD]
      API calls:   62.41%  1.13137s     10000  113.14us  72.704us  990.02us  cudaMemcpyAsync
                   37.59%  681.33ms     10000  68.132us  50.176us  1.1919ms  cudaLaunchKernel

