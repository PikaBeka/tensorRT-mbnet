==31279== NVPROF is profiling process 31279, command: ./mbnet
==31279== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==31279== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==31279== Profiling application: ./mbnet
==31279== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   69.09%  3.38759s     10004  338.62us  122.27us  369.28us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                   13.58%  666.06ms     10026  66.433us  1.7920us  75.105us  [CUDA memcpy DtoH]
                    7.46%  365.93ms     20048  18.252us  6.0480us  31.168us  [CUDA memcpy DtoD]
                    6.70%  328.62ms     40117  8.1910us     512ns  22.752us  [CUDA memcpy HtoD]
                    1.68%  82.133ms     40081  2.0490us     640ns  51.777us  [CUDA memset]
                    0.22%  10.664ms        27  394.95us  390.91us  400.99us  void gemv2N_kernel<int, int, float2, float2, float2, int=128, int=8, int=4, int=4, int=1, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const )
                    0.10%  5.0522ms         5  1.0104ms  530.15us  2.7390ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=3, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.10%  5.0225ms         3  1.6742ms  1.6715ms  1.6760ms  void gemv2T_kernel_val<int, int, float2, float2, float2, int=128, int=16, int=2, int=2, bool=0, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const , float2, float2)
                    0.08%  3.9583ms         5  791.67us  284.16us  2.7700ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.08%  3.8268ms        10  382.68us  255.04us  527.75us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=4, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  2.9941ms        10  299.41us  276.80us  317.79us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  2.9110ms         5  582.21us  575.40us  587.40us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=4>, fused::KpqkPtrWriter<float, int=1, int=1, int=4>, float, float, int=5, int=3, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  1.5689ms        16  98.054us  96.833us  99.649us  void op_generic_tensor_kernel<int=3, float, float, float, int=256, cudnnGenericOp_t=0, cudnnNanPropagation_t=0, int=0>(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, cudnnTensorStruct, float const *, float, float, float, cudnnActivationStruct, reducedDivisorArray, int)
                    0.03%  1.5451ms         5  309.03us  299.52us  316.00us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  1.4655ms         3  488.49us  478.88us  504.00us  trt_maxwell_scudnn_128x128_relu_medium_nn_v0
                    0.03%  1.4617ms         3  487.22us  481.00us  497.48us  trt_maxwell_scudnn_128x128_relu_large_nn_v0
                    0.03%  1.4562ms         3  485.41us  476.64us  497.48us  trt_maxwell_scudnn_128x128_relu_small_nn_v0
                    0.03%  1.4428ms         3  480.93us  473.48us  493.60us  trt_maxwell_scudnn_128x128_relu_large_nn_v1
                    0.03%  1.4358ms         3  478.61us  471.36us  492.96us  trt_maxwell_scudnn_128x128_relu_interior_nn_v0
                    0.03%  1.4294ms         5  285.88us  279.04us  305.12us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  1.4281ms         3  476.02us  465.00us  493.00us  trt_maxwell_scudnn_128x128_relu_medium_nn_v1
                    0.03%  1.4033ms         3  467.76us  462.11us  477.92us  trt_maxwell_scudnn_128x128_relu_small_nn_v1
                    0.03%  1.3935ms         3  464.51us  455.71us  478.12us  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                    0.03%  1.3817ms         5  276.35us  265.28us  293.73us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=5, int=2, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  1.3515ms         5  270.30us  261.12us  286.24us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=3, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  1.3326ms         3  444.20us  432.68us  459.88us  void explicit_convolve_sgemm<float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0>(int, int, int, float const *, int, float const *, int, float*, kernel_conv_params, __int64, int, __int64, int, float, float, int, float const *, float const *)
                    0.03%  1.3049ms         7  186.42us  182.43us  199.68us  void implicit_convolve_sgemm<float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=0, bool=0, bool=1>(int, int, int, float const *, int, float*, float const *, kernel_conv_params, __int64, int, float, float, int, float const *, float const *, bool, int, int)
                    0.02%  1.0589ms         3  352.97us  343.65us  368.36us  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=1, unsigned char=0, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig2DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=2, int=64, int=64, int=256, char=4, bool=0, bool=1, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.02%  1.0106ms         4  252.64us  247.68us  264.00us  trt_maxwell_scudnn_128x64_relu_large_nn_v1
                    0.02%  1.0032ms         4  250.81us  244.83us  266.91us  trt_maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.02%  984.87us         4  246.22us  241.60us  259.39us  trt_maxwell_scudnn_128x64_relu_small_nn_v1
                    0.02%  970.79us         4  242.70us  234.27us  258.40us  trt_maxwell_scudnn_128x64_relu_interior_nn_v1
                    0.02%  945.64us         4  236.41us  232.48us  247.68us  trt_maxwell_scudnn_128x64_relu_large_nn_v0
                    0.02%  943.85us         4  235.96us  231.97us  243.36us  trt_maxwell_scudnn_128x64_relu_medium_nn_v0
                    0.02%  930.60us         4  232.65us  229.76us  240.99us  trt_maxwell_scudnn_128x64_relu_small_nn_v0
                    0.02%  909.12us         4  227.28us  223.52us  236.99us  trt_maxwell_scudnn_128x64_relu_interior_nn_v0
                    0.01%  733.19us        27  27.155us  22.880us  46.272us  void fft2d_c2r_32x32<float, bool=0, bool=0, unsigned int=0, bool=0, bool=0>(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*, int2, int, int)
                    0.01%  698.44us         4  174.61us  165.25us  192.51us  trt_maxwell_scudnn_128x32_relu_large_nn_v1
                    0.01%  673.67us         4  168.42us  160.16us  188.83us  trt_maxwell_scudnn_128x32_relu_medium_nn_v1
                    0.01%  663.46us        27  24.572us  20.512us  40.000us  void fft2d_r2c_32x32<float, bool=0, unsigned int=0, bool=0>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.01%  657.60us         4  164.40us  157.12us  182.43us  trt_maxwell_scudnn_128x32_relu_small_nn_v1
                    0.01%  635.62us         4  158.91us  151.36us  177.09us  trt_maxwell_scudnn_128x32_relu_interior_nn_v1
                    0.01%  565.48us         4  141.37us  138.88us  147.39us  trt_maxwell_scudnn_128x32_relu_large_nn_v0
                    0.01%  561.19us         4  140.30us  137.57us  146.11us  trt_maxwell_scudnn_128x32_relu_medium_nn_v0
                    0.01%  546.95us         4  136.74us  134.43us  143.36us  trt_maxwell_scudnn_128x32_relu_small_nn_v0
                    0.01%  499.97us         9  55.552us  28.672us  69.248us  void transpose_readWrite_alignment_kernel<float2, float2, int=1, bool=0, int=6, int=4, int=4>(cublasTransposeParams<float2>, float2 const *, float2*, float2 const *)
                    0.01%  377.80us         4  94.448us  92.993us  98.593us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::IdentityCoordMapper<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayN, int, int, int, float const *, void*, genericReformat::ArrayN, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayN, int, int, int, float const , int=4)
                    0.01%  327.52us         6  54.587us  28.320us  75.489us  void fft2d_r2c_64x64<float, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int)
                    0.01%  298.91us         3  99.638us  99.392us  99.809us  void fft2d_c2r_64x64<float, bool=0, bool=1>(float*, float2*, int, int, int, int, int, int, int, int, int, int, float, float, int, float*, float*)
                    0.01%  261.60us        25  10.464us  8.9610us  12.160us  void cask_trt::computeOffsetsKernel<bool=0, bool=0>(cask_trt::ComputeOffsetsParams)
                    0.00%  236.22us         3  78.741us  77.312us  80.000us  void cudnn::cnn::im2col4d_kernel<float, long>(cudnn::cnn::im2col4d_params, cudnnConvolutionStruct, cudnnTensorStruct, float const *, cudnnTensorStruct*)
                    0.00%  235.01us         4  58.752us  52.160us  75.233us  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=1, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=0, unsigned char=1, bool=1, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig1DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=1, int=256, int=1, int=64, char=4, bool=1, bool=0, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.00%  137.44us         4  34.360us  33.120us  37.728us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::ArrayN<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::ArrayN<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::ArrayN<int=4>>, void const *, int, int, int, float const *, void*, void const *, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, void const *, int, int, int, float const , int=4)
                    0.00%  82.592us         3  27.530us  23.072us  36.160us  void fft2d_r2c_32x32<float, bool=0, unsigned int=5, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.00%  17.088us         3  5.6960us  5.2800us  6.4000us  void flip_filter<float, float>(float*, float const *, int, int, int, int)
      API calls:   15.17%  9.61703s    260173  36.963us  1.2160us  3.60571s  cudaFree
                   11.08%  7.02510s     80026  87.785us  7.5840us  5.23071s  cudaMemGetInfo
                   10.21%  6.46841s     10003  646.65us  80.928us  3.9633ms  cudaHostAlloc
                    9.37%  5.93775s     50010  118.73us  28.096us  113.17ms  cudaMemcpy
                    8.14%  5.16037s    140146  36.821us  14.048us  1.3570ms  cudaMalloc
                    7.63%  4.83728s     30049  160.98us  2.8160us  13.067ms  cudaStreamSynchronize
                    6.57%  4.16186s     10003  416.06us  43.936us  2.4291ms  cudaFreeHost
                    6.11%  3.87036s     80025  48.364us  2.8480us  3.29956s  cudaStreamCreateWithFlags
                    4.01%  2.54231s     10320  246.35us  28.704us  1.95351s  cudaLaunchKernel
                    3.40%  2.15450s    810304  2.6580us     576ns  1.1666ms  cudaDeviceGetAttribute
                    3.04%  1.92400s       159  12.101ms  8.8320us  237.27ms  cuModuleUnload
                    2.97%  1.88291s     20233  93.061us     992ns  865.83us  cudaMemcpyAsync
                    2.25%  1.42926s    480141  2.9760us  1.3760us  2.6242ms  cudaEventDestroy
                    1.98%  1.25657s    480138  2.6170us  1.3760us  951.94us  cudaEventCreateWithFlags
                    1.98%  1.25429s     30014  41.790us  27.072us  2.5331ms  cudaGetDeviceProperties
                    1.67%  1.05681s     40081  26.366us  13.664us  1.1138ms  cudaMemsetAsync
                    1.45%  918.23ms     70021  13.113us  4.0320us  1.2451ms  cudaDeviceSynchronize
                    1.40%  886.23ms    130038  6.8150us  3.0080us  3.5952ms  cudaStreamDestroy
                    0.32%  199.99ms     60026  3.3310us  1.2480us  633.76us  cudaGetDevice
                    0.27%  169.68ms     40012  4.2400us  2.8480us  638.28us  cudaStreamCreateWithPriority
                    0.24%  151.33ms       174  869.71us  99.808us  13.425ms  cudaEventSynchronize
                    0.23%  144.60ms     10001  14.458us  10.624us  181.76us  cudaStreamCreate
                    0.15%  94.446ms     50490  1.8700us     416ns  668.39us  cudaGetLastError
                    0.14%  91.093ms     10393  8.7640us  1.8240us  634.50us  cudaEventRecord
                    0.10%  62.343ms     10003  6.2320us  4.0320us  187.20us  cudaHostGetDevicePointer
                    0.06%  38.995ms     30010  1.2990us     384ns  630.05us  cudaGetDeviceCount
                    0.04%  23.143ms     10003  2.3130us  1.7920us  43.072us  cudaDeviceGetStreamPriorityRange
                    0.02%  9.6326ms     20008     481ns     320ns  62.976us  cudaRuntimeGetVersion
                    0.01%  6.6671ms     10004     666ns     416ns  70.497us  cudaDriverGetVersion
                    0.01%  5.3216ms       174  30.583us  11.680us  201.95us  cudaStreamAddCallback
                    0.00%  1.2441ms       174  7.1490us  3.6800us  14.656us  cudaEventElapsedTime
                    0.00%  658.44us       568  1.1590us     416ns  48.608us  cuDeviceGetAttribute
                    0.00%  422.59us        11  38.417us  30.752us  66.209us  cudaCreateTextureObject
                    0.00%  245.09us        87  2.8170us  1.7920us  5.8240us  cudaStreamWaitEvent
                    0.00%  148.58us        11  13.507us  10.688us  17.984us  cudaDestroyTextureObject
                    0.00%  80.866us         6  13.477us  7.1680us  19.168us  cuDeviceTotalMem
                    0.00%  39.808us         3  13.269us  11.232us  15.936us  cudaEventCreate
                    0.00%  26.880us         5  5.3760us  3.7440us  6.5920us  cuInit
                    0.00%  16.096us         8  2.0120us  1.1200us  4.7040us  cuDeviceGetCount
                    0.00%  12.544us         5  2.5080us  1.4400us  4.3200us  cuDriverGetVersion
                    0.00%  10.496us         6  1.7490us  1.1200us  2.3680us  cuDeviceGetName
                    0.00%  8.5760us        11     779ns     544ns     960ns  cudaCreateChannelDesc
                    0.00%  8.0960us         7  1.1560us     800ns  1.8880us  cuDeviceGet
                    0.00%  5.0560us         7     722ns     576ns     896ns  cudaPeekAtLastError
                    0.00%  4.5440us         2  2.2720us  2.1440us  2.4000us  cuDevicePrimaryCtxRelease
                    0.00%  4.2880us         6     714ns     576ns  1.0240us  cuDeviceGetUuid

==31279== NVTX result:
==31279==   Thread "<unnamed>" (id = 2316472336)
==31279==     Domain "TensorRT"
==31279==       Range "(Unnamed Layer* 0) [Convolution]"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  761.48ms     10000  76.148us  63.457us  813.22us  (Unnamed Layer* 0) [Convolution]
 GPU activities:  100.00%  3.38709s     10000  338.71us  122.27us  369.28us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
      API calls:  100.00%  571.74ms     10000  57.174us  47.073us  793.41us  cudaLaunchKernel

==31279==       Range "ExecutionContext::execute"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  6.51698s     10000  651.70us  344.13us  13.357ms  ExecutionContext::execute
 GPU activities:   95.09%  3.38709s     10000  338.71us  122.27us  369.28us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    4.91%  174.77ms     10000  17.477us  6.4000us  21.120us  [CUDA memcpy DtoD]
      API calls:   55.75%  720.25ms     10000  72.024us  50.752us  511.56us  cudaMemcpyAsync
                   44.25%  571.74ms     10000  57.174us  47.073us  793.41us  cudaLaunchKernel

