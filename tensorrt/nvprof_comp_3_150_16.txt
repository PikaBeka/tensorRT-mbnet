==21245== NVPROF is profiling process 21245, command: ./mbnet
==21245== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==21245== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==21245== Profiling application: ./mbnet
==21245== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   88.41%  31.0349s     10003  3.1026ms  450.08us  5.6202ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    6.97%  2.44603s     10026  243.97us     800ns  843.49us  [CUDA memcpy DtoH]
                    2.05%  720.37ms     20048  35.932us  8.3200us  73.664us  [CUDA memcpy DtoD]
                    1.83%  643.71ms     40115  16.046us     320ns  617.83us  [CUDA memcpy HtoD]
                    0.14%  49.430ms     40080  1.2330us     160ns  307.27us  [CUDA memset]
                    0.06%  21.186ms       108  196.17us  168.80us  596.80us  void gemv2N_kernel<int, int, float2, float2, float2, int=128, int=8, int=4, int=4, int=1, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const )
                    0.06%  19.884ms        10  1.9884ms  857.67us  5.4218ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=4, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.04%  14.964ms         5  2.9928ms  1.1050ms  8.1233ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=3, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  12.029ms         6  2.0048ms  793.77us  3.2291ms  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=1, unsigned char=0, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig2DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=2, int=64, int=64, int=256, char=4, bool=0, bool=1, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.03%  10.978ms         5  2.1956ms  2.1867ms  2.2224ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=4>, fused::KpqkPtrWriter<float, int=1, int=1, int=4>, float, float, int=5, int=3, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.03%  10.932ms        10  1.0932ms  1.0851ms  1.1010ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.02%  7.0644ms         3  2.3548ms  1.6398ms  3.2638ms  trt_maxwell_scudnn_128x128_relu_medium_nn_v1
                    0.02%  6.4021ms         3  2.1340ms  2.1253ms  2.1438ms  void explicit_convolve_sgemm<float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0>(int, int, int, float const *, int, float const *, int, float*, kernel_conv_params, __int64, int, __int64, int, float, float, int, float const *, float const *)
                    0.02%  5.5170ms         3  1.8390ms  1.6730ms  2.1595ms  trt_maxwell_scudnn_128x128_relu_large_nn_v0
                    0.02%  5.5005ms         5  1.1001ms  1.0906ms  1.1090ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.02%  5.3994ms         5  1.0799ms  1.0774ms  1.0826ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.02%  5.2867ms         5  1.0573ms  1.0513ms  1.0686ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=5, int=2, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.01%  5.0297ms         3  1.6766ms  1.6693ms  1.6827ms  trt_maxwell_scudnn_128x128_relu_medium_nn_v0
                    0.01%  4.9919ms         3  1.6640ms  1.6581ms  1.6715ms  trt_maxwell_scudnn_128x128_relu_large_nn_v1
                    0.01%  4.9870ms         3  1.6623ms  1.6541ms  1.6701ms  trt_maxwell_scudnn_128x128_relu_small_nn_v0
                    0.01%  4.8732ms         3  1.6244ms  1.6183ms  1.6354ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v0
                    0.01%  4.8621ms         3  1.6207ms  1.6161ms  1.6287ms  trt_maxwell_scudnn_128x128_relu_small_nn_v1
                    0.01%  4.7850ms         3  1.5950ms  1.5877ms  1.6011ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                    0.01%  4.4827ms         5  896.53us  884.81us  906.15us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=3, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.01%  4.3630ms         5  872.59us  869.51us  878.41us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.01%  3.1230ms         3  1.0410ms  865.77us  1.3900ms  trt_maxwell_scudnn_128x64_relu_large_nn_v1
                    0.01%  2.8280ms         3  942.67us  937.93us  951.53us  void implicit_convolve_sgemm<float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=0, bool=0, bool=1>(int, int, int, float const *, int, float*, float const *, kernel_conv_params, __int64, int, float, float, int, float const *, float const *, bool, int, int)
                    0.01%  2.8116ms        12  234.30us  205.12us  241.60us  void op_generic_tensor_kernel<int=3, float, float, float, int=256, cudnnGenericOp_t=0, cudnnNanPropagation_t=0, int=0>(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, cudnnTensorStruct, float const *, float, float, float, cudnnActivationStruct, reducedDivisorArray, int)
                    0.01%  2.5990ms         3  866.34us  862.89us  868.65us  trt_maxwell_scudnn_128x64_relu_large_nn_v0
                    0.01%  2.5945ms         3  864.85us  858.73us  872.33us  trt_maxwell_scudnn_128x64_relu_medium_nn_v0
                    0.01%  2.5469ms         3  848.97us  846.57us  853.61us  trt_maxwell_scudnn_128x64_relu_small_nn_v0
                    0.01%  2.5443ms         3  848.11us  843.21us  855.24us  trt_maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.01%  2.4918ms         3  830.59us  825.03us  841.61us  trt_maxwell_scudnn_128x64_relu_small_nn_v1
                    0.01%  2.4857ms         3  828.58us  822.31us  838.31us  trt_maxwell_scudnn_128x64_relu_interior_nn_v0
                    0.01%  2.4457ms         3  815.25us  808.61us  824.49us  trt_maxwell_scudnn_128x64_relu_interior_nn_v1
                    0.01%  1.8575ms         3  619.17us  610.18us  630.31us  maxwell_scudnn_128x32_relu_small_nn_v1
                    0.00%  1.7204ms         3  573.47us  563.59us  588.39us  trt_maxwell_scudnn_128x32_relu_large_nn_v1
                    0.00%  1.6880ms         3  562.67us  551.56us  568.32us  trt_maxwell_scudnn_128x32_relu_medium_nn_v1
                    0.00%  1.6852ms       108  15.603us  9.6000us  32.032us  void fft2d_c2r_32x32<float, bool=0, bool=0, unsigned int=0, bool=0, bool=0>(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*, int2, int, int)
                    0.00%  1.6440ms       108  15.221us  7.0410us  402.72us  void fft2d_r2c_32x32<float, bool=0, unsigned int=0, bool=0>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.00%  1.5913ms         3  530.45us  525.76us  539.52us  trt_maxwell_scudnn_128x32_relu_small_nn_v1
                    0.00%  1.5662ms         3  522.06us  516.13us  525.41us  trt_maxwell_scudnn_128x32_relu_large_nn_v0
                    0.00%  1.5561ms         3  518.71us  515.68us  523.52us  trt_maxwell_scudnn_128x32_relu_medium_nn_v0
                    0.00%  1.5251ms         3  508.36us  501.57us  520.80us  trt_maxwell_scudnn_128x32_relu_interior_nn_v1
                    0.00%  1.5145ms         3  504.83us  500.93us  510.85us  trt_maxwell_scudnn_128x32_relu_small_nn_v0
                    0.00%  1.3894ms         3  463.15us  462.40us  463.59us  void cudnn::cnn::im2col4d_kernel<float, long>(cudnn::cnn::im2col4d_params, cudnnConvolutionStruct, cudnnTensorStruct, float const *, cudnnTensorStruct*)
                    0.00%  1.0760ms         3  358.67us  351.46us  371.11us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::IdentityCoordMapper<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayN, int, int, int, float const *, void*, genericReformat::ArrayN, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayN, int, int, int, float const , int=4)
                    0.00%  914.21us         4  228.55us  226.15us  230.72us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::ArrayN<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::ArrayN<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::ArrayN<int=4>>, void const *, int, int, int, float const *, void*, void const *, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, void const *, int, int, int, float const , int=4)
                    0.00%  374.79us        25  14.991us  14.752us  15.520us  void cask_trt::computeOffsetsKernel<bool=0, bool=0>(cask_trt::ComputeOffsetsParams)
                    0.00%  94.976us         3  31.658us  29.408us  33.888us  void fft2d_r2c_32x32<float, bool=0, unsigned int=5, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.00%  52.033us         3  17.344us  17.057us  17.600us  void cask_cudnn::computeOffsetsKernel<bool=0, bool=0>(cask_cudnn::ComputeOffsetsParams)
      API calls:   34.06%  44.5795s     30048  1.4836ms  3.2000us  10.975ms  cudaStreamSynchronize
                   21.55%  28.2074s     50010  564.04us  28.480us  6.1583ms  cudaMemcpy
                   10.00%  13.0847s    260171  50.292us  1.2160us  1.29136s  cudaFree
                    7.49%  9.80240s    140144  69.945us  13.632us  4.7438ms  cudaMalloc
                    4.88%  6.38548s     10003  638.36us  134.50us  4.3860ms  cudaHostAlloc
                    3.30%  4.32063s     80026  53.990us  7.5520us  2.38017s  cudaMemGetInfo
                    2.97%  3.89117s     10003  389.00us  44.833us  1.5493ms  cudaFreeHost
                    2.52%  3.29584s     80025  41.185us  2.7840us  2.72344s  cudaStreamCreateWithFlags
                    1.95%  2.55177s     20230  126.14us     928ns  838.44us  cudaMemcpyAsync
                    1.90%  2.48063s     10519  235.82us  27.168us  1.77677s  cudaLaunchKernel
                    1.62%  2.12657s    810304  2.6240us     576ns  2.1837ms  cudaDeviceGetAttribute
                    1.27%  1.65678s       159  10.420ms  9.1200us  222.29ms  cuModuleUnload
                    1.22%  1.59085s    480141  3.3130us  1.3760us  1.8909ms  cudaEventDestroy
                    1.08%  1.41222s    480138  2.9410us  1.4080us  821.80us  cudaEventCreateWithFlags
                    0.94%  1.23228s     30014  41.056us  27.136us  749.61us  cudaGetDeviceProperties
                    0.88%  1.15303s     40080  28.768us  13.856us  118.86ms  cudaMemsetAsync
                    0.76%  1.00122s    130038  7.6990us  3.4240us  683.27us  cudaStreamDestroy
                    0.74%  971.59ms     70021  13.875us  3.8720us  968.17us  cudaDeviceSynchronize
                    0.18%  233.61ms       152  1.5369ms  353.67us  10.906ms  cudaEventSynchronize
                    0.15%  202.65ms     60026  3.3760us  1.2480us  667.46us  cudaGetDevice
                    0.12%  158.57ms     40012  3.9630us  2.7840us  660.29us  cudaStreamCreateWithPriority
                    0.11%  149.03ms     10001  14.901us  11.616us  139.14us  cudaStreamCreate
                    0.10%  124.94ms     10337  12.086us  1.9840us  840.23us  cudaEventRecord
                    0.09%  122.61ms     50654  2.4200us     416ns  629.25us  cudaGetLastError
                    0.05%  61.443ms     10003  6.1420us  4.0960us  146.08us  cudaHostGetDevicePointer
                    0.03%  39.688ms     30010  1.3220us     416ns  702.76us  cudaGetDeviceCount
                    0.02%  22.921ms     10003  2.2910us  1.7920us  134.91us  cudaDeviceGetStreamPriorityRange
                    0.01%  13.303ms     20008     664ns     416ns  703.17us  cudaRuntimeGetVersion
                    0.01%  6.9850ms     10004     698ns     480ns  70.145us  cudaDriverGetVersion
                    0.00%  5.3262ms       152  35.040us  16.128us  197.89us  cudaStreamAddCallback
                    0.00%  1.3358ms       152  8.7880us  4.1600us  36.224us  cudaEventElapsedTime
                    0.00%  786.57us       568  1.3840us     416ns  106.53us  cuDeviceGetAttribute
                    0.00%  618.85us        11  56.259us  42.561us  87.841us  cudaCreateTextureObject
                    0.00%  520.48us       156  3.3360us  1.8560us  7.1680us  cudaStreamWaitEvent
                    0.00%  153.22us        11  13.928us  11.360us  19.488us  cudaDestroyTextureObject
                    0.00%  84.833us         6  14.138us  8.8000us  20.352us  cuDeviceTotalMem
                    0.00%  37.312us         3  12.437us  11.008us  13.696us  cudaEventCreate
                    0.00%  28.032us         5  5.6060us  4.4160us  6.8800us  cuInit
                    0.00%  15.682us        11  1.4250us     672ns  7.2010us  cudaCreateChannelDesc
                    0.00%  12.864us         8  1.6080us     896ns  3.2640us  cuDeviceGetCount
                    0.00%  12.706us         5  2.5410us  1.9200us  4.6730us  cuDriverGetVersion
                    0.00%  11.744us         6  1.9570us  1.6320us  2.4320us  cuDeviceGetName
                    0.00%  8.2240us         7  1.1740us     960ns  1.7280us  cuDeviceGet
                    0.00%  7.2650us         6  1.2100us     672ns  2.9120us  cudaPeekAtLastError
                    0.00%  4.6080us         6     768ns     640ns     928ns  cuDeviceGetUuid
                    0.00%  3.9040us         2  1.9520us  1.8880us  2.0160us  cuDevicePrimaryCtxRelease

==21245== NVTX result:
==21245==   Thread "<unnamed>" (id = 1692655632)
==21245==     Domain "TensorRT"
==21245==       Range "(Unnamed Layer* 0) [Convolution]"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  910.02ms     10000  91.001us  68.833us  1.3047ms  (Unnamed Layer* 0) [Convolution]
 GPU activities:  100.00%  31.0336s     10000  3.1034ms  453.76us  5.6202ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
      API calls:  100.00%  681.29ms     10000  68.129us  50.401us  1.2686ms  cudaLaunchKernel

==21245==       Range "ExecutionContext::execute"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  41.1682s     10000  4.1168ms  805.54us  11.486ms  ExecutionContext::execute
 GPU activities:   98.86%  31.0336s     10000  3.1034ms  453.76us  5.6202ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    1.14%  356.34ms     10000  35.634us  13.440us  73.664us  [CUDA memcpy DtoD]
      API calls:   62.81%  1.15066s     10000  115.07us  72.353us  838.44us  cudaMemcpyAsync
                   37.19%  681.29ms     10000  68.129us  50.401us  1.2686ms  cudaLaunchKernel

