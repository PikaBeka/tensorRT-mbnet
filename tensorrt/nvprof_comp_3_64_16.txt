==27524== NVPROF is profiling process 27524, command: ./mbnet
==27524== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==27524== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==27524== Profiling application: ./mbnet
==27524== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   72.22%  3.11491s     10004  311.37us  217.47us  334.30us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                   10.41%  449.08ms     10026  44.791us  1.6320us  604.19us  [CUDA memcpy DtoH]
                    8.41%  362.69ms     40117  9.0400us     512ns  31.200us  [CUDA memcpy HtoD]
                    5.50%  237.01ms     20048  11.821us  6.2720us  19.840us  [CUDA memcpy DtoD]
                    1.11%  47.711ms     40081  1.1900us     640ns  152.96us  [CUDA memset]
                    0.28%  11.877ms        27  439.88us  406.72us  1.1048ms  void gemv2N_kernel<int, int, float2, float2, float2, int=128, int=8, int=4, int=4, int=1, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const )
                    0.20%  8.7812ms         5  1.7562ms  1.0195ms  3.2945ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=4>, fused::KpqkPtrWriter<float, int=1, int=1, int=4>, float, float, int=5, int=3, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.13%  5.5653ms         3  1.8551ms  1.8549ms  1.8553ms  void gemv2T_kernel_val<int, int, float2, float2, float2, int=128, int=16, int=2, int=2, bool=0, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const , float2, float2)
                    0.12%  5.2323ms        10  523.23us  514.82us  529.12us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.09%  3.8107ms        10  381.07us  370.47us  403.07us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=4, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.07%  2.8592ms         6  476.53us  349.12us  607.84us  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=1, unsigned char=0, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig2DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=2, int=64, int=64, int=256, char=4, bool=0, bool=1, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.06%  2.6847ms         5  536.95us  517.03us  556.48us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=3, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  2.6395ms         5  527.91us  523.20us  537.19us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  2.6332ms         5  526.64us  512.54us  541.92us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  2.5803ms         3  860.11us  850.56us  873.60us  void explicit_convolve_sgemm<float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0>(int, int, int, float const *, int, float const *, int, float*, kernel_conv_params, __int64, int, __int64, int, float, float, int, float const *, float const *)
                    0.06%  2.5374ms         5  507.48us  500.16us  524.54us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=5, int=2, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  2.4267ms         3  808.91us  801.28us  820.32us  trt_maxwell_scudnn_128x128_relu_large_nn_v0
                    0.06%  2.4190ms         3  806.35us  800.93us  815.07us  trt_maxwell_scudnn_128x128_relu_medium_nn_v0
                    0.06%  2.3978ms         3  799.27us  793.83us  809.19us  trt_maxwell_scudnn_128x128_relu_large_nn_v1
                    0.06%  2.3965ms         3  798.84us  792.96us  808.16us  trt_maxwell_scudnn_128x128_relu_small_nn_v0
                    0.06%  2.3776ms         3  792.55us  785.76us  799.04us  trt_maxwell_scudnn_128x128_relu_medium_nn_v1
                    0.05%  2.3695ms         3  789.83us  778.27us  802.21us  trt_maxwell_scudnn_128x128_relu_interior_nn_v0
                    0.05%  2.3528ms         3  784.28us  781.31us  788.48us  trt_maxwell_scudnn_128x128_relu_small_nn_v1
                    0.05%  2.3279ms         6  387.98us  383.71us  395.14us  void implicit_convolve_sgemm<float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=0, bool=0, bool=1>(int, int, int, float const *, int, float*, float const *, kernel_conv_params, __int64, int, float, float, int, float const *, float const *, bool, int, int)
                    0.05%  2.3244ms         3  774.80us  769.03us  782.08us  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                    0.05%  2.0002ms         5  400.04us  393.28us  407.20us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=3, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.05%  1.9769ms         5  395.38us  370.40us  432.16us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.04%  1.7872ms        15  119.15us  117.60us  120.51us  void op_generic_tensor_kernel<int=3, float, float, float, int=256, cudnnGenericOp_t=0, cudnnNanPropagation_t=0, int=0>(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, cudnnTensorStruct, float const *, float, float, float, cudnnActivationStruct, reducedDivisorArray, int)
                    0.03%  1.3087ms         3  436.23us  427.36us  448.19us  trt_maxwell_scudnn_128x64_relu_large_nn_v1
                    0.03%  1.2949ms         3  431.63us  422.02us  444.16us  trt_maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.03%  1.2567ms         3  418.89us  412.67us  431.20us  trt_maxwell_scudnn_128x64_relu_small_nn_v1
                    0.03%  1.2461ms         3  415.38us  410.43us  425.12us  trt_maxwell_scudnn_128x64_relu_large_nn_v0
                    0.03%  1.2430ms         3  414.35us  409.66us  422.50us  trt_maxwell_scudnn_128x64_relu_medium_nn_v0
                    0.03%  1.2300ms         3  410.00us  402.94us  424.00us  trt_maxwell_scudnn_128x64_relu_interior_nn_v1
                    0.03%  1.2149ms         3  404.98us  401.51us  411.68us  trt_maxwell_scudnn_128x64_relu_small_nn_v0
                    0.03%  1.1862ms         3  395.41us  391.71us  402.37us  trt_maxwell_scudnn_128x64_relu_interior_nn_v0
                    0.03%  1.1762ms         4  294.04us  285.44us  307.36us  trt_maxwell_scudnn_128x32_relu_large_nn_v1
                    0.03%  1.1344ms         4  283.60us  275.52us  299.94us  trt_maxwell_scudnn_128x32_relu_medium_nn_v1
                    0.03%  1.0925ms         4  273.11us  46.112us  951.30us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::ArrayN<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::ArrayN<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::ArrayN<int=4>>, void const *, int, int, int, float const *, void*, void const *, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, void const *, int, int, int, float const , int=4)
                    0.03%  1.0885ms         4  272.13us  261.79us  292.80us  trt_maxwell_scudnn_128x32_relu_small_nn_v1
                    0.02%  1.0325ms         4  258.14us  249.60us  271.68us  trt_maxwell_scudnn_128x32_relu_interior_nn_v1
                    0.02%  999.71us         4  249.93us  246.88us  256.26us  trt_maxwell_scudnn_128x32_relu_large_nn_v0
                    0.02%  994.30us         4  248.58us  245.63us  254.56us  trt_maxwell_scudnn_128x32_relu_medium_nn_v0
                    0.02%  956.51us         4  239.13us  236.96us  244.00us  trt_maxwell_scudnn_128x32_relu_small_nn_v0
                    0.02%  900.71us        27  33.359us  25.984us  47.776us  void fft2d_c2r_32x32<float, bool=0, bool=0, unsigned int=0, bool=0, bool=0>(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*, int2, int, int)
                    0.02%  700.61us        27  25.948us  18.400us  43.200us  void fft2d_r2c_32x32<float, bool=0, unsigned int=0, bool=0>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.02%  696.96us         6  116.16us  43.840us  190.08us  void fft2d_r2c_64x64<float, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int)
                    0.01%  561.28us         9  62.364us  32.320us  92.736us  void transpose_readWrite_alignment_kernel<float2, float2, int=1, bool=0, int=6, int=4, int=4>(cublasTransposeParams<float2>, float2 const *, float2*, float2 const *)
                    0.01%  554.53us         3  184.84us  183.81us  185.44us  void cudnn::cnn::im2col4d_kernel<float, long>(cudnn::cnn::im2col4d_params, cudnnConvolutionStruct, cudnnTensorStruct, float const *, cudnnTensorStruct*)
                    0.01%  498.08us         4  124.52us  122.56us  130.05us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::IdentityCoordMapper<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayN, int, int, int, float const *, void*, genericReformat::ArrayN, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayN, int, int, int, float const , int=4)
                    0.01%  424.16us         3  141.39us  140.06us  142.82us  void fft2d_c2r_64x64<float, bool=0, bool=1>(float*, float2*, int, int, int, int, int, int, int, int, int, int, float, float, int, float*, float*)
                    0.01%  250.50us        25  10.019us  9.7920us  10.208us  void cask_trt::computeOffsetsKernel<bool=0, bool=0>(cask_trt::ComputeOffsetsParams)
                    0.00%  175.59us         3  58.528us  57.440us  60.064us  void fft2d_r2c_32x32<float, bool=0, unsigned int=5, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.00%  24.480us         3  8.1600us  7.6800us  9.0240us  void flip_filter<float, float>(float*, float const *, int, int, int, int)
      API calls:   18.06%  16.4028s     30049  545.87us  3.0720us  25.164ms  cudaStreamSynchronize
                   17.06%  15.4867s     50010  309.67us  29.600us  122.75ms  cudaMemcpy
                   10.00%  9.08286s     10003  908.01us  55.808us  37.527ms  cudaFreeHost
                    9.35%  8.49008s     10003  848.75us  75.360us  19.838ms  cudaHostAlloc
                    8.96%  8.13502s    260173  31.267us  1.2480us  1.97720s  cudaFree
                    6.26%  5.67980s    140146  40.527us  14.112us  20.431ms  cudaMalloc
                    5.97%  5.42502s     80026  67.790us  7.5200us  3.42086s  cudaMemGetInfo
                    4.55%  4.13291s     80025  51.645us  3.0080us  3.53021s  cudaStreamCreateWithFlags
                    3.22%  2.92444s     10309  283.68us  27.968us  2.21226s  cudaLaunchKernel
                    2.48%  2.25308s    810304  2.7800us     832ns  16.239ms  cudaDeviceGetAttribute
                    2.38%  2.16187s     20233  106.85us     896ns  37.824ms  cudaMemcpyAsync
                    2.14%  1.94539s       159  12.235ms  9.6960us  257.16ms  cuModuleUnload
                    1.73%  1.57042s    480141  3.2700us  1.4080us  20.152ms  cudaEventDestroy
                    1.53%  1.38726s    480138  2.8890us  1.3760us  23.704ms  cudaEventCreateWithFlags
                    1.45%  1.31743s     30014  43.893us  27.424us  27.533ms  cudaGetDeviceProperties
                    1.23%  1.11998s    130038  8.6120us  3.4240us  21.961ms  cudaStreamDestroy
                    1.23%  1.11564s     40081  27.834us  14.080us  14.648ms  cudaMemsetAsync
                    1.15%  1.04160s     70021  14.875us  3.9680us  20.703ms  cudaDeviceSynchronize
                    0.30%  269.38ms     60026  4.4870us  1.2800us  10.565ms  cudaGetDevice
                    0.19%  173.48ms     40012  4.3350us  2.8160us  9.0794ms  cudaStreamCreateWithPriority
                    0.16%  144.72ms     10001  14.470us  11.168us  4.0544ms  cudaStreamCreate
                    0.15%  133.79ms       164  815.78us  276.83us  5.0031ms  cudaEventSynchronize
                    0.13%  113.79ms     10373  10.969us  1.7280us  14.909ms  cudaEventRecord
                    0.12%  111.16ms     50470  2.2020us     416ns  722.79us  cudaGetLastError
                    0.07%  64.678ms     10003  6.4650us  3.8400us  224.96us  cudaHostGetDevicePointer
                    0.05%  42.569ms     30010  1.4180us     416ns  667.52us  cudaGetDeviceCount
                    0.03%  26.017ms       164  158.64us  13.952us  13.788ms  cudaStreamAddCallback
                    0.03%  22.858ms     10003  2.2850us  1.7920us  346.63us  cudaDeviceGetStreamPriorityRange
                    0.02%  17.036ms     20008     851ns     416ns  4.0330ms  cudaRuntimeGetVersion
                    0.01%  6.9336ms     10004     693ns     448ns  169.51us  cudaDriverGetVersion
                    0.00%  1.0384ms       164  6.3310us  4.1280us  12.928us  cudaEventElapsedTime
                    0.00%  645.76us       568  1.1360us     448ns  45.472us  cuDeviceGetAttribute
                    0.00%  306.82us        11  27.892us  23.616us  33.536us  cudaCreateTextureObject
                    0.00%  238.05us        87  2.7360us  1.6960us  5.9520us  cudaStreamWaitEvent
                    0.00%  124.45us        11  11.313us  8.9280us  13.152us  cudaDestroyTextureObject
                    0.00%  81.472us         6  13.578us  6.8800us  21.408us  cuDeviceTotalMem
                    0.00%  27.648us         3  9.2160us  6.9440us  11.392us  cudaEventCreate
                    0.00%  26.081us         5  5.2160us  4.0320us  6.1760us  cuInit
                    0.00%  12.928us         8  1.6160us     800ns  2.9440us  cuDeviceGetCount
                    0.00%  12.768us         5  2.5530us  1.6960us  4.6080us  cuDriverGetVersion
                    0.00%  10.496us         6  1.7490us  1.3760us  2.2080us  cuDeviceGetName
                    0.00%  8.8000us         7  1.2570us     768ns  1.9520us  cuDeviceGet
                    0.00%  7.5200us        11     683ns     608ns     864ns  cudaCreateChannelDesc
                    0.00%  4.9600us         6     826ns     640ns     992ns  cuDeviceGetUuid
                    0.00%  4.8960us         6     816ns     736ns     928ns  cudaPeekAtLastError
                    0.00%  3.6480us         2  1.8240us  1.6320us  2.0160us  cuDevicePrimaryCtxRelease

==27524== NVTX result:
==27524==   Thread "<unnamed>" (id = 2762256400)
==27524==     Domain "TensorRT"
==27524==       Range "(Unnamed Layer* 0) [Convolution]"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  919.79ms     10000  91.978us  63.136us  10.956ms  (Unnamed Layer* 0) [Convolution]
 GPU activities:  100.00%  3.11403s     10000  311.40us  219.52us  334.30us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
      API calls:  100.00%  697.75ms     10000  69.775us  46.656us  10.899ms  cudaLaunchKernel

==27524==       Range "ExecutionContext::execute"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  11.8484s     10000  1.1848ms  460.38us  40.137ms  ExecutionContext::execute
 GPU activities:   96.65%  3.11403s     10000  311.40us  219.52us  334.30us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    3.35%  107.77ms     10000  10.777us  6.9130us  16.480us  [CUDA memcpy DtoD]
      API calls:   57.56%  946.21ms     10000  94.621us  53.728us  37.824ms  cudaMemcpyAsync
                   42.44%  697.75ms     10000  69.775us  46.656us  10.899ms  cudaLaunchKernel

