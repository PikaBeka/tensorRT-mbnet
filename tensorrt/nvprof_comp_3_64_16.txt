==16974== NVPROF is profiling process 16974, command: ./mbnet
==16974== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==16974== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==16974== Profiling application: ./mbnet
==16974== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   71.31%  2.22726s     10004  222.64us  162.50us  239.52us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                   10.43%  325.91ms     10026  32.506us  1.7280us  90.081us  [CUDA memcpy DtoH]
                    8.44%  263.66ms     40117  6.5720us     480ns  23.264us  [CUDA memcpy HtoD]
                    5.63%  175.80ms     20048  8.7680us  5.1840us  18.944us  [CUDA memcpy DtoD]
                    1.14%  35.589ms     40081     887ns     480ns  153.63us  [CUDA memset]
                    0.36%  11.289ms        27  418.10us  405.92us  428.96us  void gemv2N_kernel<int, int, float2, float2, float2, int=128, int=8, int=4, int=4, int=1, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const )
                    0.28%  8.6091ms         5  1.7218ms  1.0313ms  3.1554ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=4>, fused::KpqkPtrWriter<float, int=1, int=1, int=4>, float, float, int=5, int=3, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.18%  5.5604ms         3  1.8535ms  1.8515ms  1.8572ms  void gemv2T_kernel_val<int, int, float2, float2, float2, int=128, int=16, int=2, int=2, bool=0, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const , float2, float2)
                    0.13%  3.9438ms        10  394.38us  355.23us  545.76us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.10%  3.1919ms        10  319.19us  245.06us  390.88us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=4, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.09%  2.8972ms         6  482.86us  356.99us  618.75us  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=1, unsigned char=0, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig2DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=2, int=64, int=64, int=256, char=4, bool=0, bool=1, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.09%  2.8024ms         5  560.49us  552.00us  565.60us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=3, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.08%  2.5904ms         3  863.48us  853.12us  881.12us  void explicit_convolve_sgemm<float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0>(int, int, int, float const *, int, float const *, int, float*, kernel_conv_params, __int64, int, __int64, int, float, float, int, float const *, float const *)
                    0.08%  2.4221ms         3  807.36us  801.60us  818.69us  trt_maxwell_scudnn_128x128_relu_medium_nn_v0
                    0.08%  2.4198ms         3  806.62us  799.81us  816.32us  trt_maxwell_scudnn_128x128_relu_large_nn_v0
                    0.08%  2.4030ms         3  801.02us  793.63us  814.69us  trt_maxwell_scudnn_128x128_relu_small_nn_v0
                    0.08%  2.3965ms         3  798.84us  793.31us  808.99us  trt_maxwell_scudnn_128x128_relu_large_nn_v1
                    0.08%  2.3794ms         3  793.14us  783.55us  804.00us  trt_maxwell_scudnn_128x128_relu_medium_nn_v1
                    0.08%  2.3677ms         3  789.24us  778.88us  802.59us  trt_maxwell_scudnn_128x128_relu_interior_nn_v0
                    0.08%  2.3470ms         3  782.35us  773.38us  788.71us  trt_maxwell_scudnn_128x128_relu_small_nn_v1
                    0.07%  2.3249ms         6  387.48us  382.88us  394.02us  void implicit_convolve_sgemm<float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=0, bool=0, bool=1>(int, int, int, float const *, int, float*, float const *, kernel_conv_params, __int64, int, float, float, int, float const *, float const *, bool, int, int)
                    0.07%  2.3201ms         3  773.36us  768.03us  776.96us  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                    0.07%  2.1659ms         5  433.17us  426.24us  436.19us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.7978ms         5  359.55us  355.68us  368.26us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.7859ms        15  119.06us  117.28us  120.38us  void op_generic_tensor_kernel<int=3, float, float, float, int=256, cudnnGenericOp_t=0, cudnnNanPropagation_t=0, int=0>(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, cudnnTensorStruct, float const *, float, float, float, cudnnActivationStruct, reducedDivisorArray, int)
                    0.06%  1.7799ms         5  355.97us  350.24us  359.39us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.7207ms         5  344.13us  336.32us  358.40us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=5, int=2, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.04%  1.3716ms         5  274.31us  267.87us  281.89us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=3, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.04%  1.3084ms         3  436.13us  428.99us  445.15us  trt_maxwell_scudnn_128x64_relu_large_nn_v1
                    0.04%  1.2918ms         3  430.60us  423.75us  443.20us  trt_maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.04%  1.2613ms         3  420.43us  413.50us  433.86us  trt_maxwell_scudnn_128x64_relu_small_nn_v1
                    0.04%  1.2477ms         3  415.92us  410.62us  424.32us  trt_maxwell_scudnn_128x64_relu_medium_nn_v0
                    0.04%  1.2441ms         3  414.71us  409.92us  424.23us  trt_maxwell_scudnn_128x64_relu_large_nn_v0
                    0.04%  1.2339ms         3  411.29us  403.46us  426.72us  trt_maxwell_scudnn_128x64_relu_interior_nn_v1
                    0.04%  1.2249ms         3  408.29us  403.52us  416.83us  trt_maxwell_scudnn_128x64_relu_small_nn_v0
                    0.04%  1.1933ms         3  397.76us  393.79us  404.93us  trt_maxwell_scudnn_128x64_relu_interior_nn_v0
                    0.04%  1.1693ms         4  292.33us  285.92us  304.99us  trt_maxwell_scudnn_128x32_relu_large_nn_v1
                    0.04%  1.1472ms         4  286.80us  278.78us  303.20us  trt_maxwell_scudnn_128x32_relu_medium_nn_v1
                    0.03%  1.0796ms         4  269.90us  261.28us  288.07us  trt_maxwell_scudnn_128x32_relu_small_nn_v1
                    0.03%  1.0472ms         4  261.81us  252.83us  276.16us  trt_maxwell_scudnn_128x32_relu_interior_nn_v1
                    0.03%  997.19us         4  249.30us  247.36us  254.43us  trt_maxwell_scudnn_128x32_relu_large_nn_v0
                    0.03%  993.48us         4  248.37us  245.83us  252.00us  trt_maxwell_scudnn_128x32_relu_medium_nn_v0
                    0.03%  953.28us         4  238.32us  236.00us  244.58us  trt_maxwell_scudnn_128x32_relu_small_nn_v0
                    0.03%  856.68us        27  31.728us  26.080us  46.784us  void fft2d_c2r_32x32<float, bool=0, bool=0, unsigned int=0, bool=0, bool=0>(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*, int2, int, int)
                    0.02%  696.58us         6  116.10us  41.761us  188.64us  void fft2d_r2c_64x64<float, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int)
                    0.02%  679.36us        27  25.161us  19.264us  38.784us  void fft2d_r2c_32x32<float, bool=0, unsigned int=0, bool=0>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.02%  570.72us         9  63.413us  31.680us  91.360us  void transpose_readWrite_alignment_kernel<float2, float2, int=1, bool=0, int=6, int=4, int=4>(cublasTransposeParams<float2>, float2 const *, float2*, float2 const *)
                    0.02%  557.47us         3  185.82us  184.96us  186.56us  void cudnn::cnn::im2col4d_kernel<float, long>(cudnn::cnn::im2col4d_params, cudnnConvolutionStruct, cudnnTensorStruct, float const *, cudnnTensorStruct*)
                    0.02%  498.78us         4  124.70us  122.85us  130.11us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::IdentityCoordMapper<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayN, int, int, int, float const *, void*, genericReformat::ArrayN, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayN, int, int, int, float const , int=4)
                    0.01%  424.19us         3  141.40us  140.48us  142.27us  void fft2d_c2r_64x64<float, bool=0, bool=1>(float*, float2*, int, int, int, int, int, int, int, int, int, int, float, float, int, float*, float*)
                    0.01%  242.43us        25  9.6970us  9.3120us  10.112us  void cask_trt::computeOffsetsKernel<bool=0, bool=0>(cask_trt::ComputeOffsetsParams)
                    0.01%  188.80us         4  47.200us  45.280us  52.960us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::ArrayN<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::ArrayN<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::ArrayN<int=4>>, void const *, int, int, int, float const *, void*, void const *, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, void const *, int, int, int, float const , int=4)
                    0.01%  170.02us         3  56.672us  55.200us  58.976us  void fft2d_r2c_32x32<float, bool=0, unsigned int=5, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.00%  23.616us         3  7.8720us  7.3920us  8.8320us  void flip_filter<float, float>(float*, float const *, int, int, int, int)
      API calls:   19.16%  13.8767s     50010  277.48us  29.376us  117.04ms  cudaMemcpy
                   14.50%  10.5049s     30049  349.59us  2.9120us  11.323ms  cudaStreamSynchronize
                   10.43%  7.55229s    260173  29.027us  1.2480us  1.27181s  cudaFree
                    8.24%  5.96617s     10003  596.44us  79.904us  6.0865ms  cudaHostAlloc
                    8.02%  5.81013s    140146  41.457us  14.016us  10.961ms  cudaMalloc
                    6.76%  4.89626s     80026  61.183us  7.4560us  2.78372s  cudaMemGetInfo
                    5.27%  3.81423s     10003  381.31us  43.840us  3.2679ms  cudaFreeHost
                    4.64%  3.35742s     80025  41.954us  3.2000us  2.72554s  cudaStreamCreateWithFlags
                    3.50%  2.53205s     10309  245.62us  27.231us  1.89718s  cudaLaunchKernel
                    3.17%  2.29461s    810304  2.8310us     832ns  4.2294ms  cudaDeviceGetAttribute
                    2.92%  2.11147s     20233  104.36us     896ns  1.3068ms  cudaMemcpyAsync
                    2.03%  1.46877s       159  9.2375ms  9.5040us  171.72ms  cuModuleUnload
                    2.01%  1.45736s    480141  3.0350us  1.4400us  1.2898ms  cudaEventDestroy
                    1.87%  1.35122s    480138  2.8140us  1.4080us  10.441ms  cudaEventCreateWithFlags
                    1.82%  1.31604s     30014  43.847us  26.592us  4.6474ms  cudaGetDeviceProperties
                    1.52%  1.10342s     40081  27.529us  13.984us  1.5236ms  cudaMemsetAsync
                    1.37%  992.84ms    130038  7.6350us  3.1360us  2.2336ms  cudaStreamDestroy
                    1.32%  954.46ms     70021  13.630us  3.9360us  2.8574ms  cudaDeviceSynchronize
                    0.32%  232.00ms     60026  3.8640us  1.2800us  679.55us  cudaGetDevice
                    0.24%  172.90ms     40012  4.3210us  2.8800us  794.30us  cudaStreamCreateWithPriority
                    0.23%  164.08ms     10001  16.406us  11.200us  4.2052ms  cudaStreamCreate
                    0.19%  139.91ms       164  853.08us  112.32us  7.4187ms  cudaEventSynchronize
                    0.14%  103.95ms     10373  10.021us  1.6640us  829.34us  cudaEventRecord
                    0.11%  81.303ms     50470  1.6100us     448ns  724.06us  cudaGetLastError
                    0.10%  69.307ms     10003  6.9280us  3.6800us  192.86us  cudaHostGetDevicePointer
                    0.06%  45.931ms     30010  1.5300us     416ns  732.13us  cudaGetDeviceCount
                    0.04%  26.168ms     10003  2.6160us  1.8560us  354.27us  cudaDeviceGetStreamPriorityRange
                    0.02%  13.329ms     20008     666ns     416ns  99.488us  cudaRuntimeGetVersion
                    0.01%  8.0766ms     10004     807ns     544ns  65.344us  cudaDriverGetVersion
                    0.01%  6.3374ms       164  38.642us  14.336us  490.53us  cudaStreamAddCallback
                    0.00%  1.1937ms       164  7.2780us  4.0320us  21.600us  cudaEventElapsedTime
                    0.00%  703.55us       568  1.2380us     448ns  53.216us  cuDeviceGetAttribute
                    0.00%  420.67us        11  38.242us  31.456us  56.896us  cudaCreateTextureObject
                    0.00%  288.51us        87  3.3160us  1.8240us  7.2000us  cudaStreamWaitEvent
                    0.00%  147.10us        11  13.373us  11.488us  16.128us  cudaDestroyTextureObject
                    0.00%  94.080us         6  15.680us  7.5840us  20.768us  cuDeviceTotalMem
                    0.00%  36.576us         3  12.192us  8.9600us  14.528us  cudaEventCreate
                    0.00%  27.776us         5  5.5550us  4.2880us  6.3680us  cuInit
                    0.00%  13.696us         5  2.7390us  1.7920us  4.6400us  cuDriverGetVersion
                    0.00%  12.064us         8  1.5080us     832ns  2.8800us  cuDeviceGetCount
                    0.00%  9.9200us        11     901ns     640ns  1.5360us  cudaCreateChannelDesc
                    0.00%  9.6000us         6  1.6000us  1.3120us  2.1120us  cuDeviceGetName
                    0.00%  8.6400us         7  1.2340us  1.0240us  1.9200us  cuDeviceGet
                    0.00%  5.6320us         6     938ns     768ns  1.4400us  cuDeviceGetUuid
                    0.00%  4.8640us         6     810ns     576ns  1.3760us  cudaPeekAtLastError
                    0.00%  4.6080us         2  2.3040us  2.0160us  2.5920us  cuDevicePrimaryCtxRelease

==16974== NVTX result:
==16974==   Thread "<unnamed>" (id = 1782333456)
==16974==     Domain "TensorRT"
==16974==       Range "(Unnamed Layer* 0) [Convolution]"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  821.59ms     10000  82.159us  65.184us  1.4060ms  (Unnamed Layer* 0) [Convolution]
 GPU activities:  100.00%  2.22639s     10000  222.64us  162.50us  239.52us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
      API calls:  100.00%  618.44ms     10000  61.844us  48.960us  1.3778ms  cudaLaunchKernel

==16974==       Range "ExecutionContext::execute"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  9.24040s     10000  924.04us  412.51us  11.543ms  ExecutionContext::execute
 GPU activities:   96.54%  2.22639s     10000  222.64us  162.50us  239.52us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    3.46%  79.688ms     10000  7.9680us  5.1840us  11.616us  [CUDA memcpy DtoD]
      API calls:   58.65%  877.12ms     10000  87.711us  54.464us  842.59us  cudaMemcpyAsync
                   41.35%  618.44ms     10000  61.844us  48.960us  1.3778ms  cudaLaunchKernel

