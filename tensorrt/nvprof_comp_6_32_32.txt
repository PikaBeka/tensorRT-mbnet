==29082== NVPROF is profiling process 29082, command: ./mbnet
==29082== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==29082== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==29082== Profiling application: ./mbnet
==29082== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   66.50%  1.44051s     10004  143.99us  113.38us  176.00us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    9.33%  202.21ms     20048  10.086us  6.6240us  521.19us  [CUDA memcpy DtoD]
                    9.33%  202.18ms     40137  5.0370us     512ns  17.984us  [CUDA memcpy HtoD]
                    8.98%  194.62ms     10026  19.411us  2.3360us  576.67us  [CUDA memcpy DtoH]
                    2.35%  50.962ms     40091  1.2710us     640ns  458.37us  [CUDA memset]
                    0.19%  4.1787ms         3  1.3929ms  1.3920ms  1.3941ms  void gemv2T_kernel_val<int, int, float2, float2, float2, int=128, int=16, int=2, int=2, bool=0, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const , float2, float2)
                    0.19%  4.1624ms         5  832.49us  537.44us  1.8384ms  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=4>, fused::KpqkPtrWriter<float, int=1, int=1, int=4>, float, float, int=5, int=3, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.16%  3.5416ms         3  1.1805ms  1.1789ms  1.1827ms  void gemv2N_kernel<int, int, float2, float2, float2, int=128, int=8, int=4, int=4, int=1, cublasGemvParams<cublasGemvTensorStridedBatched<float2 const >, cublasGemvTensorStridedBatched<float2>, float2>>(float2 const )
                    0.13%  2.8660ms         5  573.20us  555.84us  606.24us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=4>, fused::KpqkPtrWriter<float, int=1, int=1, int=4>, float, float, int=5, int=3, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.13%  2.8580ms        10  285.80us  276.51us  299.68us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=5, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.12%  2.6491ms        10  264.91us  255.04us  277.92us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.09%  1.9705ms        10  197.05us  190.24us  206.40us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=4, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.08%  1.7795ms         5  355.90us  350.34us  361.60us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=3, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.08%  1.7129ms         3  570.98us  562.56us  586.88us  void explicit_convolve_sgemm<float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0>(int, int, int, float const *, int, float const *, int, float*, kernel_conv_params, __int64, int, __int64, int, float, float, int, float const *, float const *)
                    0.08%  1.6751ms         6  279.18us  270.11us  285.92us  void implicit_convolve_sgemm<float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=0, bool=0, bool=1>(int, int, int, float const *, int, float*, float const *, kernel_conv_params, __int64, int, float, float, int, float const *, float const *, bool, int, int)
                    0.07%  1.5905ms        15  106.04us  104.48us  107.65us  void op_generic_tensor_kernel<int=3, float, float, float, int=256, cudnnGenericOp_t=0, cudnnNanPropagation_t=0, int=0>(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, cudnnTensorStruct, float const *, float, float, float, cudnnActivationStruct, reducedDivisorArray, int)
                    0.07%  1.5643ms         3  521.44us  515.52us  525.12us  trt_maxwell_scudnn_128x128_relu_large_nn_v0
                    0.07%  1.5608ms         3  520.27us  515.11us  524.00us  trt_maxwell_scudnn_128x128_relu_medium_nn_v0
                    0.07%  1.5557ms         3  518.56us  513.70us  521.76us  trt_maxwell_scudnn_128x128_relu_large_nn_v1
                    0.07%  1.5472ms         3  515.73us  512.16us  519.52us  trt_maxwell_scudnn_128x128_relu_small_nn_v0
                    0.07%  1.5394ms         3  513.12us  507.84us  517.92us  trt_maxwell_scudnn_128x128_relu_medium_nn_v1
                    0.07%  1.5275ms         5  305.50us  288.32us  348.00us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=4, int=5, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.07%  1.5185ms         3  506.16us  500.23us  513.76us  trt_maxwell_scudnn_128x128_relu_interior_nn_v0
                    0.07%  1.5167ms         3  505.58us  502.08us  509.09us  trt_maxwell_scudnn_128x128_relu_small_nn_v1
                    0.07%  1.4999ms         5  299.98us  283.52us  337.19us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=3, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.07%  1.4968ms         3  498.92us  493.76us  505.76us  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                    0.06%  1.3851ms         5  277.02us  268.64us  284.48us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.3242ms         5  264.83us  258.53us  277.92us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=2, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.2957ms         5  259.15us  254.08us  270.91us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=2>, fused::KpqkPtrWriter<float, int=1, int=1, int=2>, float, float, int=5, int=2, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.2765ms         8  159.57us  150.24us  183.36us  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=1, unsigned char=0, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig2DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=2, int=64, int=64, int=256, char=4, bool=0, bool=1, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.06%  1.2712ms         5  254.25us  251.68us  258.72us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=3, int=5, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.2069ms         4  301.72us  299.20us  307.20us  trt_maxwell_scudnn_128x64_relu_large_nn_v1
                    0.06%  1.1989ms         5  239.78us  233.44us  250.88us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=3, int=4, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.06%  1.1933ms         5  238.66us  228.80us  266.91us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=5, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.05%  1.1892ms         5  237.83us  233.28us  252.35us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=6, int=4, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.05%  1.1716ms         5  234.31us  212.96us  260.35us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=5, int=1, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.05%  1.1708ms         5  234.17us  226.78us  252.48us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=5, int=4, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.05%  1.1641ms         4  291.02us  286.15us  296.64us  trt_maxwell_scudnn_128x64_relu_large_nn_v0
                    0.05%  1.1574ms         4  289.36us  284.16us  296.35us  trt_maxwell_scudnn_128x64_relu_medium_nn_v0
                    0.05%  1.1537ms         4  288.43us  276.16us  294.85us  trt_maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.05%  1.1299ms         5  225.97us  221.12us  230.08us  void fused::fusedConvolutionReluKernel<fused::SrcChwcPtr_FltTex_Reader<float, int=1, int=1, int=1, int=1>, fused::KpqkPtrWriter<float, int=1, int=1, int=1>, float, float, int=4, int=4, int=2, int=5, int=5, int=1, int=1>(fused::ConvolutionParams<floatSrcType, int=1, int=1Type>)
                    0.05%  1.1269ms         4  281.72us  274.79us  291.84us  trt_maxwell_scudnn_128x64_relu_small_nn_v0
                    0.05%  1.1109ms         4  277.72us  270.79us  292.10us  trt_maxwell_scudnn_128x64_relu_interior_nn_v1
                    0.05%  1.1024ms         4  275.60us  270.08us  287.04us  trt_maxwell_scudnn_128x64_relu_small_nn_v1
                    0.05%  1.0932ms         4  273.30us  266.46us  281.12us  trt_maxwell_scudnn_128x64_relu_interior_nn_v0
                    0.04%  828.13us         4  207.03us  199.42us  222.79us  trt_maxwell_scudnn_128x32_relu_large_nn_v1
                    0.04%  807.52us         4  201.88us  189.60us  221.09us  trt_maxwell_scudnn_128x32_relu_medium_nn_v1
                    0.03%  752.29us         4  188.07us  180.00us  208.80us  trt_maxwell_scudnn_128x32_relu_small_nn_v1
                    0.03%  735.71us         4  183.93us  182.24us  184.64us  trt_maxwell_scudnn_128x32_relu_large_nn_v0
                    0.03%  727.01us         4  181.75us  179.20us  184.64us  trt_maxwell_scudnn_128x32_relu_medium_nn_v0
                    0.03%  715.23us         4  178.81us  168.80us  199.36us  trt_maxwell_scudnn_128x32_relu_interior_nn_v1
                    0.03%  688.48us         4  172.12us  167.04us  175.52us  trt_maxwell_scudnn_128x32_relu_small_nn_v0
                    0.03%  652.80us         3  217.60us  215.84us  220.48us  void fft2d_r2c_32x32<float, bool=0, unsigned int=5, bool=1>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.03%  651.20us         3  217.07us  213.25us  221.95us  void cudnn::cnn::im2col4d_kernel<float, long>(cudnn::cnn::im2col4d_params, cudnnConvolutionStruct, cudnnTensorStruct, float const *, cudnnTensorStruct*)
                    0.03%  632.48us         3  210.83us  208.83us  213.25us  void fft2d_r2c_32x32<float, bool=0, unsigned int=5, bool=0>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.02%  393.76us         6  65.626us  64.641us  67.040us  void fft2d_c2r_32x32<float, bool=0, bool=0, unsigned int=0, bool=0, bool=0>(float*, float2 const *, int, int, int, int, int, int, int, int, int, float, float, cudnn::reduced_divisor, bool, float*, float*, int2, int, int)
                    0.02%  336.96us         4  84.240us  82.080us  90.368us  void genericReformat::copyPackedKernel<float, float, bool=0, bool=1, genericReformat::IdentityCoordMapper<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayN, int, int, int, float const *, void*, genericReformat::ArrayN, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayN, int, int, int, float const , int=4)
                    0.01%  305.02us         6  50.837us  48.832us  52.480us  void fft2d_r2c_32x32<float, bool=0, unsigned int=0, bool=0>(float2*, float const *, int, int, int, int, int, int, int, int, int, cudnn::reduced_divisor, bool, int2, int, int)
                    0.01%  243.04us        25  9.7210us  9.4400us  9.9520us  void cask_trt::computeOffsetsKernel<bool=0, bool=0>(cask_trt::ComputeOffsetsParams)
                    0.00%  104.83us         4  26.208us  25.120us  28.960us  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::ArrayN<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::ArrayN<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::ArrayN<int=4>>, void const *, int, int, int, float const *, void*, void const *, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, void const *, int, int, int, float const , int=4)
                    0.00%  78.242us         3  26.080us  25.121us  27.841us  void flip_filter<float, float>(float*, float const *, int, int, int, int)
      API calls:   16.92%  15.0388s     50010  300.72us  29.056us  113.77ms  cudaMemcpy
                   16.81%  14.9468s     30059  497.25us  2.9120us  24.163ms  cudaStreamSynchronize
                   10.68%  9.49032s     10003  948.75us  77.248us  55.411ms  cudaHostAlloc
                    9.40%  8.35833s     10003  835.58us  44.736us  17.973ms  cudaFreeHost
                    8.46%  7.52089s    260193  28.905us  1.1520us  1.80237s  cudaFree
                    6.31%  5.60974s    140166  40.022us  13.120us  22.756ms  cudaMalloc
                    5.80%  5.15943s     80026  64.471us  7.7440us  3.17002s  cudaMemGetInfo
                    4.91%  4.36886s     80025  54.593us  2.8160us  3.66546s  cudaStreamCreateWithFlags
                    3.06%  2.72137s     10288  264.52us  32.192us  2.12490s  cudaLaunchKernel
                    2.62%  2.32873s    810304  2.8730us     832ns  16.072ms  cudaDeviceGetAttribute
                    2.39%  2.12865s       159  13.388ms  8.7360us  257.59ms  cuModuleUnload
                    2.37%  2.10587s     20273  103.88us     800ns  11.739ms  cudaMemcpyAsync
                    1.76%  1.56069s    480141  3.2500us  1.3760us  17.848ms  cudaEventDestroy
                    1.75%  1.55924s    480138  3.2470us  1.3760us  26.089ms  cudaEventCreateWithFlags
                    1.45%  1.28476s     30014  42.805us  26.944us  15.663ms  cudaGetDeviceProperties
                    1.42%  1.26062s     40091  31.443us  13.920us  18.871ms  cudaMemsetAsync
                    1.34%  1.19072s    130038  9.1560us  3.3600us  13.701ms  cudaStreamDestroy
                    1.07%  954.30ms     70021  13.628us  3.7760us  20.334ms  cudaDeviceSynchronize
                    0.45%  399.00ms     60026  6.6470us  1.2480us  13.927ms  cudaGetDevice
                    0.20%  175.62ms     40012  4.3890us  2.6880us  7.9633ms  cudaStreamCreateWithPriority
                    0.17%  153.78ms     10001  15.376us  10.816us  12.467ms  cudaStreamCreate
                    0.16%  144.48ms       224  644.98us  156.06us  17.361ms  cudaEventSynchronize
                    0.14%  122.98ms     10490  11.723us  1.6640us  21.151ms  cudaEventRecord
                    0.13%  117.89ms     50498  2.3340us     416ns  3.0005ms  cudaGetLastError
                    0.07%  65.485ms     10003  6.5460us  3.7760us  2.5570ms  cudaHostGetDevicePointer
                    0.06%  52.300ms     30010  1.7420us     416ns  10.449ms  cudaGetDeviceCount
                    0.03%  23.777ms     20008  1.1880us     352ns  11.030ms  cudaRuntimeGetVersion
                    0.03%  23.055ms     10003  2.3040us  1.8240us  317.89us  cudaDeviceGetStreamPriorityRange
                    0.02%  14.641ms       224  65.362us  13.280us  2.6207ms  cudaStreamAddCallback
                    0.01%  8.8284ms     10004     882ns     512ns  1.6540ms  cudaDriverGetVersion
                    0.00%  1.4456ms       224  6.4530us  4.2560us  25.536us  cudaEventElapsedTime
                    0.00%  650.18us        21  30.960us  25.216us  86.304us  cudaCreateTextureObject
                    0.00%  605.73us       568  1.0660us     416ns  49.120us  cuDeviceGetAttribute
                    0.00%  246.53us        21  11.739us  9.0560us  14.496us  cudaDestroyTextureObject
                    0.00%  242.72us        60  4.0450us  1.6960us  56.096us  cudaStreamWaitEvent
                    0.00%  85.344us         6  14.224us  7.1360us  20.384us  cuDeviceTotalMem
                    0.00%  29.697us         3  9.8990us  6.1760us  15.073us  cudaEventCreate
                    0.00%  24.928us         5  4.9850us  3.5200us  6.4960us  cuInit
                    0.00%  15.776us        21     751ns     576ns  1.0240us  cudaCreateChannelDesc
                    0.00%  12.832us         5  2.5660us  1.6640us  4.0960us  cuDriverGetVersion
                    0.00%  11.968us         8  1.4960us     928ns  2.4000us  cuDeviceGetCount
                    0.00%  10.304us         6  1.7170us  1.5360us  2.1120us  cuDeviceGetName
                    0.00%  7.6800us         7  1.0970us     800ns  1.7280us  cuDeviceGet
                    0.00%  5.6000us         8     700ns     608ns     960ns  cudaPeekAtLastError
                    0.00%  4.8960us         6     816ns     608ns  1.0240us  cuDeviceGetUuid
                    0.00%  3.5200us         2  1.7600us  1.6640us  1.8560us  cuDevicePrimaryCtxRelease

==29082== NVTX result:
==29082==   Thread "<unnamed>" (id = 1818538000)
==29082==     Domain "TensorRT"
==29082==       Range "(Unnamed Layer* 0) [Convolution]"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  771.15ms     10000  77.114us  62.528us  8.8047ms  (Unnamed Layer* 0) [Convolution]
 GPU activities:  100.00%  1.43986s     10000  143.99us  113.38us  176.00us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
      API calls:  100.00%  579.80ms     10000  57.980us  46.080us  8.7794ms  cudaLaunchKernel

==29082==       Range "ExecutionContext::execute"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  9.82074s     10000  982.07us  357.67us  24.415ms  ExecutionContext::execute
 GPU activities:   94.01%  1.43986s     10000  143.99us  113.38us  176.00us  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    5.99%  91.818ms     10000  9.1810us  6.6240us  521.19us  [CUDA memcpy DtoD]
      API calls:   58.08%  803.48ms     10000  80.347us  51.680us  9.0136ms  cudaMemcpyAsync
                   41.92%  579.80ms     10000  57.980us  46.080us  8.7794ms  cudaLaunchKernel

