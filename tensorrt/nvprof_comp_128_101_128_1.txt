==24109== NVPROF is profiling process 24109, command: ./mbnet
==24109== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==24109== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==24109== Profiling application: ./mbnet
==24109== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   44.89%  43.5021s     10003  4.3489ms  1.5152ms  10.053ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                   28.58%  27.7012s     10024  2.7635ms  1.1200us  6.2527ms  [CUDA memcpy DtoH]
                   25.32%  24.5434s     40087  612.25us     320ns  9.0474ms  [CUDA memcpy HtoD]
                    0.82%  795.93ms     20044  39.709us  12.864us  1.1832ms  [CUDA memcpy DtoD]
                    0.09%  83.432ms     40065  2.0820us     320ns  1.9706ms  [CUDA memset]
                    0.02%  22.243ms         3  7.4142ms  5.4362ms  10.125ms  void genericReformat::copyPackedKernel<float, float, bool=1, bool=1, genericReformat::ArrayN<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::ArrayN<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::ArrayN<int=4>>, void const *, int, int, int, float const *, void*, void const *, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, void const *, int, int, int, float const , int=4)
                    0.02%  21.960ms        12  1.8300ms  1.5416ms  2.0376ms  void op_generic_tensor_kernel<int=3, float, float, float, int=256, cudnnGenericOp_t=0, cudnnNanPropagation_t=0, int=0>(cudnnTensorStruct, float*, cudnnTensorStruct, float const *, cudnnTensorStruct, float const *, float, float, float, cudnnActivationStruct, reducedDivisorArray, int)
                    0.02%  19.125ms        12  1.5938ms  1.5767ms  1.6157ms  maxwell_gcgemm_64x32_nt
                    0.02%  17.896ms         3  5.9654ms  5.9439ms  5.9893ms  void implicit_convolve_sgemm<float, float, int=1024, int=5, int=5, int=3, int=3, int=3, int=1, bool=0, bool=0, bool=1>(int, int, int, float const *, int, float*, float const *, kernel_conv_params, __int64, int, float, float, int, float const *, float const *, bool, int, int)
                    0.02%  15.145ms         3  5.0485ms  3.4746ms  6.6884ms  void explicit_convolve_sgemm<float, int, int=128, int=6, int=7, int=3, int=3, int=5, int=0, bool=0>(int, int, int, float const *, int, float const *, int, float*, kernel_conv_params, __int64, int, __int64, int, float, float, int, float const *, float const *)
                    0.01%  13.871ms         6  2.3119ms  1.8695ms  2.7589ms  void CUTENSOR_NAMESPACE::permutationKernelPLC3<CUTENSOR_NAMESPACE::VectorWrite2DTensorView<unsigned char=0, unsigned char=1, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::VectorRead2DTensorView<unsigned char=1, unsigned char=0, bool=0, unsigned int=4, float, float, CUTENSOR_NAMESPACE::GeneralUnarySmall<float>>, CUTENSOR_NAMESPACE::ThreadLevelElementwise<CUTENSOR_NAMESPACE::ElementwiseConfig2DCommonCase<CUTENSOR_NAMESPACE::GeneralUnarySmall<float>, CUTENSOR_NAMESPACE::GeneralBinary<float>, int=2, int=64, int=64, int=256, char=4, bool=0, bool=1, bool=1, bool=1, bool=0>, float>, CUTENSOR_NAMESPACE::ElementwiseRuntimePLC3<float, float, float, float>::Params>(unsigned int=4)
                    0.01%  11.968ms         3  3.9894ms  3.9671ms  4.0133ms  trt_maxwell_scudnn_128x32_sliced1x4_ldg4_relu_exp_small_nhwc_tn_v1
                    0.01%  11.819ms         3  3.9398ms  3.9277ms  3.9630ms  trt_maxwell_scudnn_128x32_sliced1x4_ldg4_relu_exp_interior_nhwc_tn_v1
                    0.01%  10.284ms         3  3.4281ms  3.4054ms  3.4731ms  void genericReformat::copyPackedKernel<float, float, bool=0, bool=1, genericReformat::IdentityCoordMapper<int=4>, int=4>(unsigned int, unsigned int, void const *, genericReformat::ArrayN<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayNWithReducedDivisors<genericReformat::IdentityCoordMapper<int=4>>, genericReformat::ArrayN, int, int, int, float const *, void*, genericReformat::ArrayN, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayNWithReducedDivisors, genericReformat::ArrayN, int, int, int, float const , int=4)
                    0.01%  9.3200ms         3  3.1067ms  3.0048ms  3.2883ms  trt_maxwell_scudnn_128x32_relu_medium_nn_v1
                    0.01%  9.1815ms         3  3.0605ms  3.0507ms  3.0744ms  maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.01%  7.9712ms         3  2.6571ms  2.4506ms  3.0626ms  trt_maxwell_scudnn_128x128_relu_medium_nn_v1
                    0.01%  7.6827ms         3  2.5609ms  1.8337ms  3.3447ms  trt_maxwell_scudnn_128x64_relu_small_nn_v1
                    0.01%  7.3227ms         3  2.4409ms  2.4320ms  2.4556ms  trt_maxwell_scudnn_128x32_relu_medium_nn_v0
                    0.01%  7.1102ms         3  2.3701ms  2.3574ms  2.3880ms  trt_maxwell_scudnn_128x32_relu_small_nn_v0
                    0.01%  6.8244ms         3  2.2748ms  2.2644ms  2.2870ms  trt_maxwell_scudnn_128x32_relu_small_nn_v1
                    0.01%  6.5761ms         3  2.1920ms  2.1684ms  2.2123ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v1
                    0.01%  6.5171ms        12  543.10us  523.20us  569.86us  void fft1d_r2c_32<float, float, float2, bool=0, bool=0>(float2*, float const *, int, int3, int3, int2, int2)
                    0.01%  6.2796ms         3  2.0932ms  2.0862ms  2.1063ms  trt_maxwell_scudnn_128x32_relu_interior_nn_v0
                    0.01%  6.0882ms         3  2.0294ms  2.0245ms  2.0358ms  trt_maxwell_scudnn_128x64_relu_medium_nn_v0
                    0.01%  5.9613ms         3  1.9871ms  1.9763ms  1.9987ms  trt_maxwell_scudnn_128x64_relu_small_nn_v0
                    0.01%  5.8833ms         3  1.9611ms  1.9514ms  1.9768ms  trt_maxwell_scudnn_128x64_sliced1x2_ldg4_relu_exp_small_nhwc_tn_v1
                    0.01%  5.8607ms         3  1.9536ms  1.9443ms  1.9659ms  trt_maxwell_scudnn_128x64_sliced1x2_ldg4_relu_exp_interior_nhwc_tn_v1
                    0.01%  5.8459ms         3  1.9486ms  1.8214ms  2.1950ms  trt_maxwell_scudnn_128x128_relu_small_nn_v0
                    0.01%  5.7710ms         3  1.9237ms  1.9196ms  1.9311ms  trt_maxwell_scudnn_128x64_relu_interior_nn_v0
                    0.01%  5.6498ms         3  1.8833ms  1.8740ms  1.8952ms  trt_maxwell_scudnn_128x64_relu_medium_nn_v1
                    0.01%  5.5521ms         3  1.8507ms  1.8456ms  1.8571ms  trt_maxwell_scudnn_128x128_relu_medium_nn_v0
                    0.01%  5.4360ms         3  1.8120ms  1.8056ms  1.8231ms  trt_maxwell_scudnn_128x64_relu_interior_nn_v1
                    0.01%  5.4329ms         3  1.8110ms  1.8021ms  1.8255ms  trt_maxwell_scudnn_128x128_relu_small_nn_v1
                    0.01%  5.4094ms         3  1.8031ms  1.7925ms  1.8207ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v0
                    0.00%  3.9311ms         3  1.3104ms  1.0800ms  1.4416ms  void cudnn::cnn::im2col4d_kernel<float, long>(cudnn::cnn::im2col4d_params, cudnnConvolutionStruct, cudnnTensorStruct, float const *, cudnnTensorStruct*)
                    0.00%  2.6430ms        12  220.25us  147.10us  277.92us  void fft1d_c2r_32<float2, float, float, bool=0, bool=1, bool=0, bool=0>(float*, float2 const *, int, int3, int3, int2, int, float, float, float*, float*)
                    0.00%  1.5883ms         3  529.44us  518.98us  548.07us  void fft1d_r2c_32<float, float, float2, bool=1, bool=0>(float2*, float const *, int, int3, int3, int2, int2)
                    0.00%  303.75us        23  13.206us  12.864us  16.064us  void cask_trt::computeOffsetsKernel<bool=0, bool=0>(cask_trt::ComputeOffsetsParams)
                    0.00%  58.625us         3  19.541us  19.072us  20.480us  void cask_cudnn::computeOffsetsKernel<bool=0, bool=0>(cask_cudnn::ComputeOffsetsParams)
      API calls:   39.21%  74.2182s     50010  1.4841ms  28.448us  9.4461ms  cudaMemcpy
                   26.56%  50.2674s     30035  1.6736ms  2.8800us  10.445ms  cudaStreamSynchronize
                    7.56%  14.3154s    260143  55.028us  1.1840us  1.24018s  cudaFree
                    7.36%  13.9409s    140116  99.495us  13.665us  7.8068ms  cudaMalloc
                    3.17%  6.00383s     10003  600.20us  89.760us  2.2848ms  cudaHostAlloc
                    3.08%  5.82864s     10003  582.69us  50.144us  3.2469ms  cudaFreeHost
                    2.28%  4.31600s     80026  53.932us  7.4240us  2.45701s  cudaMemGetInfo
                    1.72%  3.26276s     80025  40.771us  3.0080us  2.69286s  cudaStreamCreateWithFlags
                    1.35%  2.55730s     10167  251.53us  27.808us  1.87872s  cudaLaunchKernel
                    1.32%  2.50674s     20172  124.27us  2.2400us  1.3387ms  cudaMemcpyAsync
                    1.10%  2.09026s    810304  2.5790us     512ns  751.49us  cudaDeviceGetAttribute
                    0.84%  1.58190s       159  9.9491ms  9.0560us  203.49ms  cuModuleUnload
                    0.82%  1.54451s    480141  3.2160us  1.4400us  3.4085ms  cudaEventDestroy
                    0.68%  1.27787s    480138  2.6610us  1.3440us  2.7467ms  cudaEventCreateWithFlags
                    0.66%  1.25683s     30014  41.874us  27.552us  1.2958ms  cudaGetDeviceProperties
                    0.60%  1.14267s     40065  28.520us  13.536us  114.29ms  cudaMemsetAsync
                    0.52%  984.30ms    130038  7.5690us  3.4240us  1.1176ms  cudaStreamDestroy
                    0.47%  894.87ms     70021  12.779us  3.7760us  1.6115ms  cudaDeviceSynchronize
                    0.17%  316.65ms        90  3.5184ms  1.8559ms  10.810ms  cudaEventSynchronize
                    0.11%  208.04ms     60026  3.4650us  1.2160us  703.78us  cudaGetDevice
                    0.10%  190.43ms     10213  18.646us  1.8560us  2.5239ms  cudaEventRecord
                    0.10%  181.23ms     10001  18.120us  14.304us  3.2666ms  cudaStreamCreate
                    0.09%  163.49ms     40012  4.0860us  2.9760us  801.86us  cudaStreamCreateWithPriority
                    0.05%  87.928ms     50243  1.7500us     384ns  827.62us  cudaGetLastError
                    0.03%  59.623ms     10003  5.9600us  3.7760us  112.23us  cudaHostGetDevicePointer
                    0.02%  41.590ms     30010  1.3850us     416ns  689.96us  cudaGetDeviceCount
                    0.01%  23.552ms     10003  2.3540us  1.8880us  68.864us  cudaDeviceGetStreamPriorityRange
                    0.01%  12.835ms     20008     641ns     384ns  673.38us  cudaRuntimeGetVersion
                    0.00%  6.0879ms     10004     608ns     416ns  40.480us  cudaDriverGetVersion
                    0.00%  5.0130ms        90  55.700us  21.536us  473.86us  cudaStreamAddCallback
                    0.00%  940.16us        90  10.446us  4.7680us  25.920us  cudaEventElapsedTime
                    0.00%  655.04us       568  1.1530us     416ns  56.192us  cuDeviceGetAttribute
                    0.00%  258.76us        60  4.3120us  1.7920us  13.408us  cudaStreamWaitEvent
                    0.00%  81.313us         6  13.552us  8.2570us  17.632us  cuDeviceTotalMem
                    0.00%  60.640us         3  20.213us  10.048us  27.360us  cudaEventCreate
                    0.00%  39.169us         8  4.8960us     896ns  26.433us  cuDeviceGetCount
                    0.00%  27.008us         5  5.4010us  4.2240us  6.5600us  cuInit
                    0.00%  13.888us         5  2.7770us  1.7600us  4.8000us  cuDriverGetVersion
                    0.00%  11.040us         6  1.8400us  1.2160us  2.4320us  cuDeviceGetName
                    0.00%  8.0000us         7  1.1420us     672ns  1.9200us  cuDeviceGet
                    0.00%  6.2720us         6  1.0450us     640ns  1.6960us  cudaPeekAtLastError
                    0.00%  5.9200us         6     986ns     704ns  1.2800us  cuDeviceGetUuid
                    0.00%  3.4560us         2  1.7280us  1.5360us  1.9200us  cuDevicePrimaryCtxRelease

==24109== NVTX result:
==24109==   Thread "<unnamed>" (id = 2678394896)
==24109==     Domain "TensorRT"
==24109==       Range "(Unnamed Layer* 0) [Convolution]"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  910.84ms     10000  91.084us  66.944us  820.04us  (Unnamed Layer* 0) [Convolution]
 GPU activities:  100.00%  43.4967s     10000  4.3497ms  1.5152ms  10.053ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
      API calls:  100.00%  666.50ms     10000  66.650us  48.320us  753.25us  cudaLaunchKernel

==24109==       Range "ExecutionContext::execute"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  49.0628s     10000  4.9063ms  1.9056ms  10.821ms  ExecutionContext::execute
 GPU activities:   99.13%  43.4967s     10000  4.3497ms  1.5152ms  10.053ms  trt_maxwell_scudnn_128x128_relu_interior_nn_v1
                    0.87%  381.86ms     10000  38.186us  15.712us  45.024us  [CUDA memcpy DtoD]
      API calls:   66.99%  1.35247s     10000  135.25us  100.64us  969.80us  cudaMemcpyAsync
                   33.01%  666.50ms     10000  66.650us  48.320us  753.25us  cudaLaunchKernel

